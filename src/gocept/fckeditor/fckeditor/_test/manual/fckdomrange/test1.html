<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 * FCKeditor - The text editor for Internet - http://www.fckeditor.net
 * Copyright (C) 2003-2007 Frederico Caldeira Knabben
 *
 * == BEGIN LICENSE ==
 *
 * Licensed under the terms of any of the following licenses at your
 * choice:
 *
 *  - GNU General Public License Version 2 or later (the "GPL")
 *    http://www.gnu.org/licenses/gpl.html
 *
 *  - GNU Lesser General Public License Version 2.1 or later (the "LGPL")
 *    http://www.gnu.org/licenses/lgpl.html
 *
 *  - Mozilla Public License Version 1.1 or later (the "MPL")
 *    http://www.mozilla.org/MPL/MPL-1.1.html
 *
 * == END LICENSE ==
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>FCKDomRange</title>
	<script src="../../../editor/_source/fckscriptloader.js" type="text/javascript"></script>
	<script src="../_common/manual_test.js" type="text/javascript"></script>
	<script type="text/javascript">

var FCK = new Object() ;

FCKScriptLoader.Load( 'FCKDomRange' ) ;
FCKScriptLoader.Load( 'FCKDebug' ) ;

	</script>
	<script type="text/javascript">

FCKConfig.Debug = true ;
FCKConfig.BasePath = '../../../editor/' ;

var oRange ;

function InnerLoaded( innerWindow )
{
	oRange = new FCKDomRange( innerWindow ) ;
}

function UpdateDetails()
{
	document.getElementById('xStartBlockLimit').innerHTML	= ( oRange.StartBlockLimit ? oRange.StartBlockLimit.tagName : 'null' ) ;
	document.getElementById('xStartBlock').innerHTML		= ( oRange.StartBlock ? oRange.StartBlock.tagName : 'null' ) ;
	document.getElementById('xStartContainer').innerHTML	= ( oRange.StartContainer ? oRange.StartContainer.tagName : 'null' ) ;
	document.getElementById('xEndBlockLimit').innerHTML		= ( oRange.EndBlockLimit ? oRange.EndBlockLimit.tagName : 'null' ) ;
	document.getElementById('xEndBlock').innerHTML			= ( oRange.EndBlock ? oRange.EndBlock.tagName : 'null' ) ;
	document.getElementById('xEndContainer').innerHTML		= ( oRange.EndContainer ? oRange.EndContainer.tagName : 'null' ) ;
}

function MoveToSelection()
{
	oRange.MoveToSelection() ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

function ExtractContents()
{
	var eDiv = oRange.Window.document.createElement( 'div' ) ;
	oRange.ExtractContents().AppendTo( eDiv ) ;
	UpdateDetails() ;
	alert( eDiv.innerHTML ) ;
	AutoSelect() ;
	oRange.Window.focus() ;
}

function DeleteContents()
{
	oRange.DeleteContents() ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

function CheckStartOfBlock()
{
	alert( oRange.CheckStartOfBlock() ) ;
	oRange.Window.focus() ;
}

function CheckEndOfBlock()
{
	alert( oRange.CheckEndOfBlock() ) ;
	oRange.Window.focus() ;
}

function Collapse()
{
	oRange.Collapse(true) ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

function CheckIsCollapsed()
{
	alert( oRange.CheckIsCollapsed() ) ;
	oRange.Window.focus() ;
}

function CheckIsEmpty()
{
	alert( oRange.CheckIsEmpty() ) ;
	oRange.Window.focus() ;
}

function SetStart()
{
	var e = oRange.Window.document.getElementsByTagName( document.getElementById('xTag').value )[0] ;
	oRange.SetStart( e, parseInt( document.getElementById('xPosition').value, 10 ) ) ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

function SetEnd()
{
	var e = oRange.Window.document.getElementsByTagName( document.getElementById('xTag').value )[0] ;
	oRange.SetEnd( e, parseInt( document.getElementById('xPosition').value, 10 ) ) ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

function Select()
{
	oRange.Select() ;
	oRange.Window.focus() ;
}

function AutoSelect()
{
	if ( document.getElementById('xAutoSelect').checked )
		oRange.Select() ;
}

function Expand( unit )
{
	oRange.Expand( unit ) ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

var oBookmark ;

function Bookmark()
{
	oBookmark = oRange.CreateBookmark() ;
}

function MoveToBookmark()
{
	oRange.MoveToBookmark( oBookmark ) ;
	AutoSelect() ;
	UpdateDetails() ;
	oRange.Window.focus() ;
}

	</script>
</head>
<body>
	<h1>
		FCKDomRange</h1>
	<p>
		<select id="xTag">
			<option value="h1">h1</option>
			<option value="h2">h2</option>
			<option value="p">p</option>
			<option value="br">br</option>
			<option value="span">span</option>
			<option value="a">a</option>
			<option value="acronym">acronym</option>
			<option value="strong">strong</option>
			<option value="ol">ol</option>
			<option value="ul">ul</option>
			<option value="li">li</option>
			<option value="table">table</option>
			<option value="tr">tr</option>
			<option value="td">td</option>
			<option value="th">td</option>
			<option value="caption">caption</option>
			<option value="blockquote">blockquote</option>
			<option value="img">img</option>
			<option value="hr">hr</option>
		</select>
		<select id="xPosition">
			<option value="1">After Start</option>
			<option value="2">Before End</option>
			<option value="3">Before Start</option>
			<option value="4">After End</option>
		</select>
		<input type="button" value="Set Start" onclick="SetStart(); return false;" />
		<input type="button" value="Set End" onclick="SetEnd(); return false;" />
		<input type="button" value="Expand Block" onclick="Expand('block_contents'); return false;" />
		<input type="button" value="Move to Selection" onclick="MoveToSelection(); return false;" />
		<input type="button" value="Bookmark" onclick="Bookmark(); return false;" />
		<input type="button" value="Move to Bookmark" onclick="MoveToBookmark(); return false;" />
	</p>
	<p>
		<input id="xAutoSelect" type="checkbox" checked="checked" />
		Auto select
		<input type="button" value="Select" onclick="Select(); FCKTools.CancelEvent( event ); return false;" />
		<input type="button" value="Update Details" onclick="UpdateDetails(); oRange.Window.focus(); return false;" />
		<input type="button" value="Delete Contents" onclick="DeleteContents(); return false;" />
		<input type="button" value="Extract Contents" onclick="ExtractContents(); return false;" />
		<input type="button" value="Check End of Block" onclick="CheckEndOfBlock(); return false;" />
		<input type="button" value="Check Start of Block" onclick="CheckStartOfBlock(); return false;" />
		<input type="button" value="Collapse" onclick="Collapse(); return false;" />
		<input type="button" value="Check Is Collapsed" onclick="CheckIsCollapsed(); return false;" />
		<input type="button" value="Check Is Empty" onclick="CheckIsEmpty(); return false;" />
	</p>
	<table>
		<tr>
			<td>
				StartBlockLimit:</td>
			<td id="xStartBlockLimit" style="font-weight: bold;">
			</td>
			<td>
				&nbsp;&nbsp;&nbsp;&nbsp;</td>
			<td>
				StartBlock:</td>
			<td id="xStartBlock" style="font-weight: bold;">
			</td>
			<td>
				&nbsp;&nbsp;&nbsp;&nbsp;</td>
			<td>
				StartContainer:</td>
			<td id="xStartContainer" style="font-weight: bold;">
			</td>
		</tr>
		<tr>
			<td>
				EndBlockLimit:</td>
			<td id="xEndBlockLimit" style="font-weight: bold;">
			</td>
			<td>
				&nbsp;&nbsp;&nbsp;&nbsp;</td>
			<td>
				EndBlock:</td>
			<td id="xEndBlock" style="font-weight: bold;">
			</td>
			<td>
				&nbsp;&nbsp;&nbsp;&nbsp;</td>
			<td>
				EndContainer:</td>
			<td id="xEndContainer" style="font-weight: bold;">
			</td>
		</tr>
	</table>
	<iframe src="test1_inner.html" width="100%" height="350" frameborder="1"></iframe>
</body>
</html>
